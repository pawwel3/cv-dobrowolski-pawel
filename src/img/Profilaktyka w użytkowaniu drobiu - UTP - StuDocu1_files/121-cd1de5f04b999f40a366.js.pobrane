(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[121],{"+6pD":function(e,t,n){"use strict";var s=n("lSNA"),a=n.n(s),r=n("q1tI"),i=n.n(r),o=n("/MKj"),l=n("d2gv"),c=n.n(l),u=n("17x9"),p=n.n(u),m=n("IP2g"),h=n("KAy6"),d=n("Elhd"),g=n.n(d),b=n("LRgy"),f=n.n(b),R=n("vDqi"),y=n.n(R),_=n("jiZR"),E=n("IrSZ"),k=n("0pXI");var v=e=>(t,n)=>{if(!e)return Promise.resolve(!1);const{properties:s}=e,a={};"Positive"===s["Document Rated"]&&(a["Last Positive Rated Document ID"]=s["Document ID"]);const{testRatingsTimeRange:r}=n().ab,i=Object(E.a)(n());return"15 Months"===r&&(s["Document Rating Past 15 Months"]=i.rating_positive-i.rating_negative),"18 Months"===r&&(s["Document Rating Past 18 Months"]=i.rating_positive-i.rating_negative),s["Document Positive Experience Probability"]=i.positiveExperienceProbability,t(Object(k.a)("Document Rated",s,a))},x=n("PMJz"),S=n("N4+1");const w=({rating_positive:e,rating_negative:t,user_rating:n,rating:s})=>({type:_.SET_RATING,payload:{rating_positive:e,rating_negative:t,user_rating:n,rating:s}});var C=(e,t,n,s,a,r,i)=>(o,l)=>{const u=n+((e,t)=>1===e&&0===t||1===e&&-1===t?-1:1!==e&&1===t?1:0)(a,t),p=s+((e,t)=>-1===e&&0===t||-1===e&&1===t?-1:-1!==e&&-1===t?1:0)(a,t),m=w({rating_positive:Math.max(0,u),rating_negative:Math.max(0,p),user_rating:t,rating:t});o(m);const{testMyLikedDocuments2:h}=l().ab,{isLoggedIn:d}=l().user;return y.a.post(g.a.route("api.documents.ratings.store",{documentId:e}),{documentId:e,rating:t}).then(e=>{const t=e.data.tracking||[];return t.properties["Rating Origin"]=r,o(v(t)),i&&d&&"With, Old Design"===h&&o(Object(S.a)(i)),e}).catch(e=>{throw o(w({rating_positive:n,rating_negative:s,user_rating:0,rating:0})),o(d?Object(x.a)(c.a.get("something_went_wrong_request")):Object(x.a)(c.a.get("need_to_sign_in_to_rate"))),e})},T=n("2iE4");const N={documentId:p.a.number.isRequired,positiveRatings:p.a.number.isRequired,negativeRatings:p.a.number.isRequired,readOnly:p.a.bool.isRequired,onRate:p.a.func.isRequired,showRatingText:p.a.bool,userRating:p.a.number,dispatch:p.a.func.isRequired,ratingOrigin:p.a.string};class O extends r.PureComponent{constructor(...e){super(...e),a()(this,"state",{disabled:this.props.readOnly}),a()(this,"handleRateClick",e=>{let t=e;this.props.readOnly||this.state.disabled||(e===this.props.userRating&&(t=0),this.setState({disabled:!0},()=>{let e;this.props.onRate(t),1===t&&(e=c.a.get("document_added_to_studylist",{studylistName:Object(h.renderToString)(i.a.createElement("a",{href:g.a.route("user.liked-documents")},i.a.createElement("strong",null,c.a.get("liked_documents_studylist_thumbs_up"))))})),this.props.dispatch(C(this.props.documentId,t,this.props.positiveRatings,this.props.negativeRatings,this.props.userRating,this.props.ratingOrigin,e)).finally(()=>this.setState({disabled:!1}))}))})}render(){const e=this.props.userRating>0?"fas":"far",t=this.props.userRating<0?"fas":"far";return i.a.createElement("div",{className:f.a.wrapper},this.props.showRatingText&&i.a.createElement("span",{className:"flex-no-shrink"},c.a.get("helpful")),i.a.createElement(T.c,{className:f.a.button,color:this.props.userRating>0?"outline-success":"light",type:"button",size:"small-wide",onClick:()=>this.handleRateClick(1),disabled:this.props.readOnly||this.state.disabled},i.a.createElement(m.a,{icon:[e,"thumbs-up"],className:f.a.thumbsUp,size:"sm"}),i.a.createElement("span",{},this.props.positiveRatings)),i.a.createElement(T.c,{className:f.a.button,color:this.props.userRating<0?"outline-danger":"light",type:"button",size:"small-wide",onClick:()=>this.handleRateClick(-1),disabled:this.props.readOnly||this.state.disabled},i.a.createElement(m.a,{icon:[t,"thumbs-down"],className:f.a.thumbsDown,size:"sm"}),i.a.createElement("span",{},this.props.negativeRatings)))}}O.propTypes=N,O.defaultProps={showRatingText:!0,userRating:null,ratingOrigin:""};t.a=Object(o.connect)()(O)},"/ulz":function(e,t,n){e.exports={"reason-wrapper":"reason-wrapper--a5n4z",reasonWrapper:"reason-wrapper--a5n4z","reason-text-wrapper":"reason-text-wrapper--DZdip",reasonTextWrapper:"reason-text-wrapper--DZdip"}},"0o9W":function(e,t,n){"use strict";var s=n("NsRu");t.a=e=>({type:s.SET_INITIAL_PERSONAL_INFO,payload:{inTrial:e}})},"2gM/":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var s=n("q1tI"),a=n.n(s),r=n("17x9"),i=n.n(r),o=n("E51F"),l=n.n(o),c=n("pLk4"),u=n("kagA");const p={uniLanguage:i.a.string.isRequired,canonicalUrl:i.a.string,appDomains:i.a.object.isRequired,selectableLanguages:i.a.array.isRequired,document:i.a.shape({noIndex:i.a.number.isRequired}).isRequired,currentLocale:i.a.string,localizedCategoryName:i.a.string,allowedLanguageCategoryName:i.a.string,fallbackLanguages:i.a.object};class m extends s.PureComponent{render(){const{canonicalUrl:e}=this.props,t=Object(c.b)(this.props.selectableLanguages,this.props.uniLanguage,this.props.fallbackLanguages),n=Object(c.a)(this.props.currentLocale,t);return this.props.document.noIndex?a.a.createElement("meta",{name:"robots",content:"noindex"}):a.a.createElement(s.Fragment,null,a.a.createElement("meta",{property:"og:url",content:e}),a.a.createElement("link",{rel:"canonical",href:e}),n&&a.a.createElement(u.a,{giveBackAllLangs:!1,currentLanguage:t,langs:this.props.selectableLanguages,canonicalUrl:e.replace(l()(this.props.localizedCategoryName),l()(this.props.allowedLanguageCategoryName)),appDomains:this.props.appDomains}))}}m.propTypes=p},"3/WH":function(e,t,n){"use strict";var s=n("gPwu");t.a=e=>({type:s.a.SET,comments:e,count:e?e.length:0})},"4V4G":function(e,t,n){e.exports={"pop-up":"pop-up--21ihD",popUp:"pop-up--21ihD","close-button":"close-button--3ECcJ",closeButton:"close-button--3ECcJ",text:"text--3Ojer","rate-buttons-wrapper":"rate-buttons-wrapper--3sIzg",rateButtonsWrapper:"rate-buttons-wrapper--3sIzg"}},AEJn:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n("4Brf");var s=n("lSNA"),a=n.n(s),r=n("q1tI"),i=n.n(r),o=n("17x9"),l=n.n(o);class c extends r.PureComponent{render(){const e={"@context":"https://schema.org","@type":"CreativeWork",name:this.props.document.title,learningResourceType:this.props.document.category_name};if(this.props.document.description&&(e.about=this.props.document.description.substring(0,500)),this.props.terms&&(e.keywords=Object.keys(this.props.terms).slice(0,20).join(",")),this.props.meta.isMetering&&!this.props.document.preview){const t=this.props.document.pages-this.props.document.previewPages;if(t>0){e.isAccessibleForFree="False",e.hasPart=[];for(let n=1;n<=t;n++)e.hasPart.push({"@type":"WebPageElement",isAccessibleForFree:"False",cssSelector:".paywall-section-"+n})}}return i.a.createElement(r.Fragment,null,i.a.createElement("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:this.props.breadcrumb}}),i.a.createElement("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:JSON.stringify(e)}}))}}a()(c,"propTypes",{document:l.a.object,breadcrumb:l.a.string,terms:l.a.array,meta:l.a.object})},BSJu:function(e,t,n){"use strict";var s=n("lSNA"),a=n.n(s),r=n("q1tI"),i=n.n(r),o=n("kX0S"),l=n("17x9"),c=n.n(l),u=n("d2gv"),p=n.n(u),m=n("Pqt4"),h=n("1dGI"),d=n("TSYQ"),g=n.n(d),b=n("2iE4"),f=n("/ulz"),R=n.n(f);const y={onReasonChange:c.a.func.isRequired,currentReason:c.a.number.isRequired,onSubmit:c.a.func.isRequired,submitButtonText:c.a.string.isRequired,submitting:c.a.bool.isRequired,course:c.a.shape({name:c.a.string.isRequired}).isRequired,showMissingAnswers:c.a.bool.isRequired};class _ extends r.Component{constructor(...e){super(...e),a()(this,"state",{customReason:"",error:""}),a()(this,"handlePickReason",e=>{this.props.onReasonChange(m.d.PICK_REASON,parseInt(e.target.value,10))}),a()(this,"handleChangeCustomReason",e=>{this.setState({customReason:e.target.value})}),a()(this,"handleSubmit",e=>{let t;return e.preventDefault(),this.props.currentReason!==m.c.OTHER||(t=this.state.customReason&&this.state.customReason.trim(),t)?this.props.onSubmit(this.props.currentReason,{customReason:t}):this.setState({error:p.a.get("report_document_error_provide_report_details")})}),a()(this,"renderReasonRadioButton",(e,t=!0,n="")=>{let s;return t&&(s=i.a.createElement("p",{className:"text-light-gray"},n||p.a.get(`report_document_reason_${e}_description`))),i.a.createElement("div",{className:g()("form-group radio-stu",R.a.reasonWrapper)},i.a.createElement("input",{type:"radio",name:"report-reason",id:e,value:e,checked:this.props.currentReason===e,onChange:this.handlePickReason}),i.a.createElement("div",{className:R.a.reasonTextWrapper},i.a.createElement("label",{htmlFor:e,className:"font-big"},p.a.get("report_document_reason_"+e)),s))})}render(){let e;return this.props.currentReason===m.c.OTHER&&(e=i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"extra-information"},p.a.get("report_reason_extra_information")),i.a.createElement("textarea",{id:"extra-information",name:"extra-information",className:"form-control-stu textarea-stu",value:this.state.customReason,onChange:this.handleChangeCustomReason}))),i.a.createElement("form",{className:"form",onSubmit:this.handleSubmit},i.a.createElement(b.k.Body,null,this.state.error&&i.a.createElement(b.a,{type:"danger"},this.state.error),this.props.showMissingAnswers&&this.renderReasonRadioButton(m.c.MISSING_ANSWERS),this.renderReasonRadioButton(m.c.WRONG_COURSE,!0,p.a.get(`report_document_reason_${m.c.WRONG_COURSE}_description`,{courseName:this.props.course.name})),this.renderReasonRadioButton(m.c.WRONG_METADATA),this.renderReasonRadioButton(m.c.BAD_CONTENT),this.renderReasonRadioButton(m.c.CANT_READ),this.renderReasonRadioButton(m.c.OTHER,!1),e),i.a.createElement(b.k.Footer,null,i.a.createElement(b.d,null,i.a.createElement(b.k.CancelButton,null,p.a.get("cancel")),i.a.createElement(b.k.SubmitButton,{component:b.e,type:"submit",loading:this.props.submitting,disabled:this.props.submitting},this.props.submitButtonText))))}}_.propTypes=y;var E=_,k=n("40VN"),v=n("Rj/V"),x=n("BXQg");const S={onSubmit:c.a.func.isRequired,onPreviousClick:c.a.func.isRequired,institution:c.a.object.isRequired,user:c.a.shape({isLoggedIn:c.a.bool.isRequired}).isRequired};class w extends r.Component{constructor(...e){super(...e),a()(this,"state",{institution:this.props.institution,course:w.initialState.course}),a()(this,"handleSubmit",e=>(e.preventDefault(),this.setState({institution:this.props.institution,course:w.initialState.course}),this.props.onSubmit(m.c.WRONG_COURSE,{institutionId:parseInt(this.state.institution.id,10),courseId:parseInt(this.state.course.id,10)}))),a()(this,"handleInstitutionChanged",e=>{e&&e.id?this.setState({institution:e,course:w.initialState.course}):this.setState({course:w.initialState.course,institution:w.initialState.institution})}),a()(this,"handleCourseSelected",e=>{this.setState({course:e})}),a()(this,"handleCourseChange",e=>this.setState(t=>({course:{...t.course,name:e}})))}render(){const e=this.state.institution.id&&this.state.course.id;return i.a.createElement("form",{className:"form report-document-modal__course-edit-form",onSubmit:this.handleSubmit},i.a.createElement(b.k.Body,null,i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"search-wrapper-institution-institution",className:"label-name"},p.a.get("institution")),i.a.createElement(k.a,{id:"institution",type:"institution",institutionId:parseInt(this.state.institution.id,10),value:this.state.institution,displayProperty:"name",onChange:this.handleInstitutionChanged,placeholder:p.a.get("search_institution"),onClear:this.handleInstitutionChanged,spinner:!0})),i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"search-wrapper-institution-institution",className:"label-name"},p.a.get("course")),i.a.createElement(x.a,{layout:"small",formControlStyle:!0,disabled:!this.state.institution.id},i.a.createElement(v.a,{id:"search-wrapper-course",type:"course",resultsNumber:4,resultsClassName:"search-input-dropdown",wrapperClassName:"searchBar__results searchBar__suggestionList",placeholder:this.state.institution.id?p.a.get("search_code_name"):p.a.get("institution_mandatory"),onSelect:this.handleCourseSelected,autofocus:!0,spinner:!0,institutionId:parseInt(this.state.institution.id,10),disabled:!this.state.institution.id,user:this.props.user,showAddButtons:!0,inputTestSelector:"report-document-course-input",value:this.state.course.name,onChange:this.handleCourseChange})))),i.a.createElement(b.k.Footer,null,i.a.createElement(b.d,null,i.a.createElement(b.k.CancelButton,{onClick:this.props.onPreviousClick},p.a.get("previous")),i.a.createElement(b.k.SubmitButton,{component:b.e,type:"submit",loading:this.props.submitting,disabled:!e||this.props.submitting},p.a.get("send")))))}}a()(w,"initialState",{course:{id:null,name:""},institution:{id:null,name:""}}),w.propTypes=S;var C=w,T=(n("4Brf"),n("ANjH")),N=n("/MKj"),O=n("Yw+G"),A=n("pJVQ"),I=n("IoCO"),D=n("W4C7"),q=n("dq6K"),M=n("8R9t"),j=n("lBLp");const P={onSubmit:c.a.func.isRequired,onPreviousClick:c.a.func.isRequired,document:c.a.object.isRequired,...O.a};class z extends r.Component{constructor(...e){super(...e),a()(this,"handleSubmit",e=>{const t={documentTitle:e["document-title"],documentDescription:e["document-description"],examContent:e["exam-content"],examYear:e["exam-year"],examMonth:e["exam-month"],examDay:e["exam-day"]};return this.props.onSubmit(m.c.WRONG_METADATA,t)})}render(){let e,t;return 4===this.props.document.category.id&&(e=i.a.createElement("div",{className:"form-group"},i.a.createElement("div",{className:"radio-checkbox-group"},i.a.createElement(D.c,{name:"exam-content",label:p.a.get("exam_content"),options:this.props.examContentTypes}))),t=this.props.examDates.map(e=>i.a.createElement("div",{className:"select-field",key:e.name},i.a.createElement(j.a,{name:e.name,placeholder:e.placeholder,options:e.options,labelKey:"label",valueKey:"value"}))),t=i.a.createElement("div",{className:"form-group report-document-modal__exam-date-form-group"},i.a.createElement("div",null,p.a.get("exam_date")),i.a.createElement("div",null,t))),i.a.createElement("form",{className:"form report-document-modal__document-metadata-edit-form",onSubmit:this.props.handleSubmit(this.handleSubmit)},i.a.createElement(b.k.Body,null,i.a.createElement(q.a,{name:"document-title",placeholder:"title","data-hj-whitelist":!0,label:p.a.get("title")}),i.a.createElement(M.a,{name:"document-description",label:p.a.get("description"),placeholder:p.a.get("description"),"data-hj-whitelist":!0}),e,t),i.a.createElement(b.k.Footer,null,i.a.createElement(b.d,null,i.a.createElement(b.k.CancelButton,{onClick:this.props.onPreviousClick},p.a.get("previous")),i.a.createElement(b.k.SubmitButton,{component:b.e,type:"submit",loading:this.props.submitting,disabled:this.props.submitting},p.a.get("send")))))}}z.propTypes=P;var L=Object(T.d)(Object(N.connect)((e,t)=>{let n=Object(I.a)(e.document.uploaderConfig.exams.dates);return n=[{name:"exam-day",dataTestSelector:"exam-day",...n.days},{name:"exam-month",dataTestSelector:"exam-month",...n.months},{name:"exam-year",dataTestSelector:"exam-year",...n.years}],{initialValues:{"document-title":t.document.title,"document-description":t.document.description,...4===t.document.category.id&&{"exam-content":""+t.document.exam.content,"exam-year":t.document.exam.year,"exam-month":t.document.exam.month,"exam-day":t.document.exam.day}},examContentTypes:Object.keys(m.e).map(e=>({name:"exam-content",label:p.a.get(e.toLowerCase()),value:""+m.e[e],dataTestSelector:`exam-content-${m.e[e]}-option`})),examDates:n}}),Object(A.a)({form:"ReportDocumentMetadataEditForm"}))(z),$=n("YzHk"),B=n("odUq");const U={show:c.a.bool.isRequired,document:c.a.object.isRequired,course:c.a.object.isRequired,user:c.a.shape({isLoggedIn:c.a.bool.isRequired}).isRequired,title:c.a.string.isRequired,currentReason:c.a.number.isRequired,step:c.a.string.isRequired,onHide:c.a.func.isRequired,reportSubmit:c.a.func.isRequired,handleChangeStepReason:c.a.func.isRequired};class F extends r.Component{constructor(...e){super(...e),a()(this,"state",{submitting:!1}),a()(this,"handleReasonPickerSubmit",(e,t=null)=>{switch(this.props.currentReason){case m.c.WRONG_COURSE:return this.props.handleChangeStepReason(m.d.PICK_COURSE,this.props.currentReason);case m.c.WRONG_METADATA:return this.props.handleChangeStepReason(m.d.EDIT_METADATA,this.props.currentReason);default:return this.handleReportSubmit(e,t)}}),a()(this,"handleReportSubmit",(e,t=null)=>(this.setState({submitting:!0}),this.props.reportSubmit(e,this.props.user.isLoggedIn,t))),a()(this,"handlePreviousClick",()=>this.props.handleChangeStepReason(m.d.PICK_REASON,this.props.currentReason)),a()(this,"renderStep",e=>{const t=[m.c.WRONG_COURSE,m.c.WRONG_METADATA],n=this.props.document.category.id===m.b.PAST_EXAMS&&this.props.document.exam.content===m.e.EXAM_QUESTIONS_ANSWERS;switch(e){case m.d.PICK_REASON:return i.a.createElement(E,{onReasonChange:this.props.handleChangeStepReason,currentReason:this.props.currentReason,onSubmit:this.handleReasonPickerSubmit,course:this.props.course,submitButtonText:t.includes(this.props.currentReason)?p.a.get("next"):p.a.get("send"),showMissingAnswers:n,submitting:this.state.submitting});case m.d.PICK_COURSE:return i.a.createElement(C,{onSubmit:this.handleReportSubmit,onPreviousClick:this.handlePreviousClick,institution:this.props.course.institution,user:this.props.user});case m.d.EDIT_METADATA:return i.a.createElement(L,{onSubmit:this.handleReportSubmit,onPreviousClick:this.handlePreviousClick,document:this.props.document});case m.d.REPORT_SUBMITTED:return i.a.createElement("div",{},i.a.createElement(b.k.Body,{className:"text-center"},i.a.createElement($.a,null),i.a.createElement("p",null,p.a.get("your_contribution_will_help_students"))),i.a.createElement(b.k.Footer,null,i.a.createElement(b.k.CancelButton,{},p.a.get("close"))));default:return null}})}render(){return i.a.createElement(b.k,{show:this.props.show,onHide:this.props.onHide,className:"report-document-modal"},i.a.createElement(b.k.Header,null,this.props.title),this.renderStep(this.props.step))}}F.propTypes=U;t.a=Object(o.connect)(e=>({document:Object(h.c)(e.document.current),course:e.course.current,user:e.user,currentReason:e.document.reportModal.currentReason,step:e.document.reportModal.step}),e=>({reportSubmit:(t,n,s=null)=>e(Object(B.a)(t,n,s)),handleChangeStepReason:(t,n)=>e(Object(B.c)(t,n))}))(F)},DlQD:function(e,t,n){!function(t){"use strict";var n={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:/^ {0,3}(`{3,}|~{3,})([^`~\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?:\n+|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6}) +([^\n]*?)(?: +#+)? *(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3})(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:"^ {0,3}(?:<(script|pre|style)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?\\?>\\n*|<![A-Z][\\s\\S]*?>\\n*|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>\\n*|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:\\n{2,}|$)|<(?!script|pre|style)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$)|</(?!script|pre|style)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:\\n{2,}|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,nptable:b,table:b,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html)[^\n]+)*)/,text:/^[^\n]+/};function s(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||k.defaults,this.rules=n.normal,this.options.pedantic?this.rules=n.pedantic:this.options.gfm&&(this.rules=n.gfm)}n._label=/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,n._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,n.def=m(n.def).replace("label",n._label).replace("title",n._title).getRegex(),n.bullet=/(?:[*+-]|\d{1,9}\.)/,n.item=/^( *)(bull) ?[^\n]*(?:\n(?!\1bull ?)[^\n]*)*/,n.item=m(n.item,"gm").replace(/bull/g,n.bullet).getRegex(),n.list=m(n.list).replace(/bull/g,n.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+n.def.source+")").getRegex(),n._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",n._comment=/<!--(?!-?>)[\s\S]*?-->/,n.html=m(n.html,"i").replace("comment",n._comment).replace("tag",n._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),n.paragraph=m(n._paragraph).replace("hr",n.hr).replace("heading"," {0,3}#{1,6} +").replace("|lheading","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}|~{3,})[^`\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|!--)").replace("tag",n._tag).getRegex(),n.blockquote=m(n.blockquote).replace("paragraph",n.paragraph).getRegex(),n.normal=f({},n),n.gfm=f({},n.normal,{nptable:/^ *([^|\n ].*\|.*)\n *([-:]+ *\|[-| :]*)(?:\n((?:.*[^>\n ].*(?:\n|$))*)\n*|$)/,table:/^ *\|(.+)\n *\|?( *[-:]+[-| :]*)(?:\n((?: *[^>\n ].*(?:\n|$))*)\n*|$)/}),n.pedantic=f({},n.normal,{html:m("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",n._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *(?:#+ *)?(?:\n+|$)/,fences:b,paragraph:m(n.normal._paragraph).replace("hr",n.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",n.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),s.rules=n,s.lex=function(e,t){var n=new s(t);return n.lex(e)},s.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},s.prototype.token=function(e,t){var s,a,r,i,o,l,c,p,m,h,d,g,b,f,_,E;for(e=e.replace(/^ +$/gm,"");e;)if((r=this.rules.newline.exec(e))&&(e=e.substring(r[0].length),r[0].length>1&&this.tokens.push({type:"space"})),r=this.rules.code.exec(e)){var k=this.tokens[this.tokens.length-1];e=e.substring(r[0].length),k&&"paragraph"===k.type?k.text+="\n"+r[0].trimRight():(r=r[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",codeBlockStyle:"indented",text:this.options.pedantic?r:y(r,"\n")}))}else if(r=this.rules.fences.exec(e))e=e.substring(r[0].length),this.tokens.push({type:"code",lang:r[2]?r[2].trim():r[2],text:r[3]||""});else if(r=this.rules.heading.exec(e))e=e.substring(r[0].length),this.tokens.push({type:"heading",depth:r[1].length,text:r[2]});else if((r=this.rules.nptable.exec(e))&&(l={type:"table",header:R(r[1].replace(/^ *| *\| *$/g,"")),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3]?r[3].replace(/\n$/,"").split("\n"):[]},l.header.length===l.align.length)){for(e=e.substring(r[0].length),d=0;d<l.align.length;d++)/^ *-+: *$/.test(l.align[d])?l.align[d]="right":/^ *:-+: *$/.test(l.align[d])?l.align[d]="center":/^ *:-+ *$/.test(l.align[d])?l.align[d]="left":l.align[d]=null;for(d=0;d<l.cells.length;d++)l.cells[d]=R(l.cells[d],l.header.length);this.tokens.push(l)}else if(r=this.rules.hr.exec(e))e=e.substring(r[0].length),this.tokens.push({type:"hr"});else if(r=this.rules.blockquote.exec(e))e=e.substring(r[0].length),this.tokens.push({type:"blockquote_start"}),r=r[0].replace(/^ *> ?/gm,""),this.token(r,t),this.tokens.push({type:"blockquote_end"});else if(r=this.rules.list.exec(e)){for(e=e.substring(r[0].length),i=r[2],f=i.length>1,c={type:"list_start",ordered:f,start:f?+i:"",loose:!1},this.tokens.push(c),r=r[0].match(this.rules.item),p=[],s=!1,b=r.length,d=0;d<b;d++)l=r[d],h=l.length,l=l.replace(/^ *([*+-]|\d+\.) */,""),~l.indexOf("\n ")&&(h-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+h+"}","gm"),"")),d!==b-1&&(o=n.bullet.exec(r[d+1])[0],(i.length>1?1===o.length:o.length>1||this.options.smartLists&&o!==i)&&(e=r.slice(d+1).join("\n")+e,d=b-1)),a=s||/\n\n(?!\s*$)/.test(l),d!==b-1&&(s="\n"===l.charAt(l.length-1),a||(a=s)),a&&(c.loose=!0),_=/^\[[ xX]\] /.test(l),E=void 0,_&&(E=" "!==l[1],l=l.replace(/^\[[ xX]\] +/,"")),m={type:"list_item_start",task:_,checked:E,loose:a},p.push(m),this.tokens.push(m),this.token(l,!1),this.tokens.push({type:"list_item_end"});if(c.loose)for(b=p.length,d=0;d<b;d++)p[d].loose=!0;this.tokens.push({type:"list_end"})}else if(r=this.rules.html.exec(e))e=e.substring(r[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===r[1]||"script"===r[1]||"style"===r[1]),text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):u(r[0]):r[0]});else if(t&&(r=this.rules.def.exec(e)))e=e.substring(r[0].length),r[3]&&(r[3]=r[3].substring(1,r[3].length-1)),g=r[1].toLowerCase().replace(/\s+/g," "),this.tokens.links[g]||(this.tokens.links[g]={href:r[2],title:r[3]});else if((r=this.rules.table.exec(e))&&(l={type:"table",header:R(r[1].replace(/^ *| *\| *$/g,"")),align:r[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:r[3]?r[3].replace(/\n$/,"").split("\n"):[]},l.header.length===l.align.length)){for(e=e.substring(r[0].length),d=0;d<l.align.length;d++)/^ *-+: *$/.test(l.align[d])?l.align[d]="right":/^ *:-+: *$/.test(l.align[d])?l.align[d]="center":/^ *:-+ *$/.test(l.align[d])?l.align[d]="left":l.align[d]=null;for(d=0;d<l.cells.length;d++)l.cells[d]=R(l.cells[d].replace(/^ *\| *| *\| *$/g,""),l.header.length);this.tokens.push(l)}else if(r=this.rules.lheading.exec(e))e=e.substring(r[0].length),this.tokens.push({type:"heading",depth:"="===r[2].charAt(0)?1:2,text:r[1]});else if(t&&(r=this.rules.paragraph.exec(e)))e=e.substring(r[0].length),this.tokens.push({type:"paragraph",text:"\n"===r[1].charAt(r[1].length-1)?r[1].slice(0,-1):r[1]});else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),this.tokens.push({type:"text",text:r[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var a={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:b,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,strong:/^__([^\s_])__(?!_)|^\*\*([^\s*])\*\*(?!\*)|^__([^\s][\s\S]*?[^\s])__(?!_)|^\*\*([^\s][\s\S]*?[^\s])\*\*(?!\*)/,em:/^_([^\s_])_(?!_)|^\*([^\s*<\[])\*(?!\*)|^_([^\s<][\s\S]*?[^\s_])_(?!_|[^\spunctuation])|^_([^\s_<][\s\S]*?[^\s])_(?!_|[^\spunctuation])|^\*([^\s<"][\s\S]*?[^\s\*])\*(?!\*|[^\spunctuation])|^\*([^\s*"<\[][\s\S]*?[^\s])\*(?!\*)/,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:b,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*]|\b_|$)|[^ ](?= {2,}\n))|(?= {2,}\n))/};function r(e,t){if(this.options=t||k.defaults,this.links=e,this.rules=a.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.pedantic?this.rules=a.pedantic:this.options.gfm&&(this.options.breaks?this.rules=a.breaks:this.rules=a.gfm)}function i(e){this.options=e||k.defaults}function o(){}function l(e){this.tokens=[],this.token=null,this.options=e||k.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options,this.slugger=new c}function c(){this.seen={}}function u(e,t){if(t){if(u.escapeTest.test(e))return e.replace(u.escapeReplace,(function(e){return u.replacements[e]}))}else if(u.escapeTestNoEncode.test(e))return e.replace(u.escapeReplaceNoEncode,(function(e){return u.replacements[e]}));return e}function p(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,(function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}function m(e,t){return e=e.source||e,t=t||"",{replace:function(t,n){return n=n.source||n,n=n.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(t,n),this},getRegex:function(){return new RegExp(e,t)}}}function h(e,t,n){if(e){try{var s=decodeURIComponent(p(n)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return null}if(0===s.indexOf("javascript:")||0===s.indexOf("vbscript:")||0===s.indexOf("data:"))return null}t&&!g.test(n)&&(n=function(e,t){d[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?d[" "+e]=e+"/":d[" "+e]=y(e,"/",!0));return e=d[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(e){return null}return n}a._punctuation="!\"#$%&'()*+,\\-./:;<=>?@\\[^_{|}~",a.em=m(a.em).replace(/punctuation/g,a._punctuation).getRegex(),a._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,a._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,a._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,a.autolink=m(a.autolink).replace("scheme",a._scheme).replace("email",a._email).getRegex(),a._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,a.tag=m(a.tag).replace("comment",n._comment).replace("attribute",a._attribute).getRegex(),a._label=/(?:\[[^\[\]]*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,a._href=/<(?:\\[<>]?|[^\s<>\\])*>|[^\s\x00-\x1f]*/,a._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,a.link=m(a.link).replace("label",a._label).replace("href",a._href).replace("title",a._title).getRegex(),a.reflink=m(a.reflink).replace("label",a._label).getRegex(),a.normal=f({},a),a.pedantic=f({},a.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/,link:m(/^!?\[(label)\]\((.*?)\)/).replace("label",a._label).getRegex(),reflink:m(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",a._label).getRegex()}),a.gfm=f({},a.normal,{escape:m(a.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~+(?=\S)([\s\S]*?\S)~+/,text:/^(`+|[^`])(?:[\s\S]*?(?:(?=[\\<!\[`*~]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))|(?= {2,}\n|[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@))/}),a.gfm.url=m(a.gfm.url,"i").replace("email",a.gfm._extended_email).getRegex(),a.breaks=f({},a.gfm,{br:m(a.br).replace("{2,}","*").getRegex(),text:m(a.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),r.rules=a,r.output=function(e,t,n){var s=new r(t,n);return s.output(e)},r.prototype.output=function(e){for(var t,n,s,a,i,o,l="";e;)if(i=this.rules.escape.exec(e))e=e.substring(i[0].length),l+=u(i[1]);else if(i=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(i[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(i[0])&&(this.inLink=!1),!this.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])?this.inRawBlock=!0:this.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])&&(this.inRawBlock=!1),e=e.substring(i[0].length),l+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):u(i[0]):i[0];else if(i=this.rules.link.exec(e)){var c=_(i[2],"()");if(c>-1){var p=4+i[1].length+c;i[2]=i[2].substring(0,c),i[0]=i[0].substring(0,p).trim(),i[3]=""}e=e.substring(i[0].length),this.inLink=!0,s=i[2],this.options.pedantic?(t=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s),t?(s=t[1],a=t[3]):a=""):a=i[3]?i[3].slice(1,-1):"",s=s.trim().replace(/^<([\s\S]*)>$/,"$1"),l+=this.outputLink(i,{href:r.escapes(s),title:r.escapes(a)}),this.inLink=!1}else if((i=this.rules.reflink.exec(e))||(i=this.rules.nolink.exec(e))){if(e=e.substring(i[0].length),t=(i[2]||i[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){l+=i[0].charAt(0),e=i[0].substring(1)+e;continue}this.inLink=!0,l+=this.outputLink(i,t),this.inLink=!1}else if(i=this.rules.strong.exec(e))e=e.substring(i[0].length),l+=this.renderer.strong(this.output(i[4]||i[3]||i[2]||i[1]));else if(i=this.rules.em.exec(e))e=e.substring(i[0].length),l+=this.renderer.em(this.output(i[6]||i[5]||i[4]||i[3]||i[2]||i[1]));else if(i=this.rules.code.exec(e))e=e.substring(i[0].length),l+=this.renderer.codespan(u(i[2].trim(),!0));else if(i=this.rules.br.exec(e))e=e.substring(i[0].length),l+=this.renderer.br();else if(i=this.rules.del.exec(e))e=e.substring(i[0].length),l+=this.renderer.del(this.output(i[1]));else if(i=this.rules.autolink.exec(e))e=e.substring(i[0].length),"@"===i[2]?(n=u(this.mangle(i[1])),s="mailto:"+n):(n=u(i[1]),s=n),l+=this.renderer.link(s,null,n);else if(this.inLink||!(i=this.rules.url.exec(e))){if(i=this.rules.text.exec(e))e=e.substring(i[0].length),this.inRawBlock?l+=this.renderer.text(this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):u(i[0]):i[0]):l+=this.renderer.text(u(this.smartypants(i[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else{if("@"===i[2])n=u(i[0]),s="mailto:"+n;else{do{o=i[0],i[0]=this.rules._backpedal.exec(i[0])[0]}while(o!==i[0]);n=u(i[0]),s="www."===i[1]?"http://"+n:n}e=e.substring(i[0].length),l+=this.renderer.link(s,null,n)}return l},r.escapes=function(e){return e?e.replace(r.rules._escapes,"$1"):e},r.prototype.outputLink=function(e,t){var n=t.href,s=t.title?u(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,s,this.output(e[1])):this.renderer.image(n,s,u(e[1]))},r.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},r.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",s=e.length,a=0;a<s;a++)t=e.charCodeAt(a),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},i.prototype.code=function(e,t,n){var s=(t||"").match(/\S*/)[0];if(this.options.highlight){var a=this.options.highlight(e,s);null!=a&&a!==e&&(n=!0,e=a)}return s?'<pre><code class="'+this.options.langPrefix+u(s,!0)+'">'+(n?e:u(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:u(e,!0))+"</code></pre>"},i.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},i.prototype.html=function(e){return e},i.prototype.heading=function(e,t,n,s){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+s.slug(n)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(e,t,n){var s=t?"ol":"ul",a=t&&1!==n?' start="'+n+'"':"";return"<"+s+a+">\n"+e+"</"+s+">\n"},i.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},i.prototype.checkbox=function(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},i.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},i.prototype.table=function(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"},i.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},i.prototype.tablecell=function(e,t){var n=t.header?"th":"td",s=t.align?"<"+n+' align="'+t.align+'">':"<"+n+">";return s+e+"</"+n+">\n"},i.prototype.strong=function(e){return"<strong>"+e+"</strong>"},i.prototype.em=function(e){return"<em>"+e+"</em>"},i.prototype.codespan=function(e){return"<code>"+e+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(e){return"<del>"+e+"</del>"},i.prototype.link=function(e,t,n){if(e=h(this.options.sanitize,this.options.baseUrl,e),null===e)return n;var s='<a href="'+u(e)+'"';return t&&(s+=' title="'+t+'"'),s+=">"+n+"</a>",s},i.prototype.image=function(e,t,n){if(e=h(this.options.sanitize,this.options.baseUrl,e),null===e)return n;var s='<img src="'+e+'" alt="'+n+'"';return t&&(s+=' title="'+t+'"'),s+=this.options.xhtml?"/>":">",s},i.prototype.text=function(e){return e},o.prototype.strong=o.prototype.em=o.prototype.codespan=o.prototype.del=o.prototype.text=function(e){return e},o.prototype.link=o.prototype.image=function(e,t,n){return""+n},o.prototype.br=function(){return""},l.parse=function(e,t){var n=new l(t);return n.parse(e)},l.prototype.parse=function(e){this.inline=new r(e.links,this.options),this.inlineText=new r(e.links,f({},this.options,{renderer:new o})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},l.prototype.next=function(){return this.token=this.tokens.pop(),this.token},l.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},l.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},l.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,p(this.inlineText.output(this.token.text)),this.slugger);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,s,a="",r="";for(n="",e=0;e<this.token.header.length;e++)n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(a+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",s=0;s<t.length;s++)n+=this.renderer.tablecell(this.inline.output(t[s]),{header:!1,align:this.token.align[s]});r+=this.renderer.tablerow(n)}return this.renderer.table(a,r);case"blockquote_start":for(r="";"blockquote_end"!==this.next().type;)r+=this.tok();return this.renderer.blockquote(r);case"list_start":r="";for(var i=this.token.ordered,o=this.token.start;"list_end"!==this.next().type;)r+=this.tok();return this.renderer.list(r,i,o);case"list_item_start":r="";var l=this.token.loose,c=this.token.checked,u=this.token.task;for(this.token.task&&(r+=this.renderer.checkbox(c));"list_item_end"!==this.next().type;)r+=l||"text"!==this.token.type?this.tok():this.parseText();return this.renderer.listitem(r,u,c);case"html":return this.renderer.html(this.token.text);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText());default:var m='Token with "'+this.token.type+'" type was not found.';if(!this.options.silent)throw new Error(m);console.log(m)}},c.prototype.slug=function(e){var t=e.toLowerCase().trim().replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");if(this.seen.hasOwnProperty(t)){var n=t;do{this.seen[n]++,t=n+"-"+this.seen[n]}while(this.seen.hasOwnProperty(t))}return this.seen[t]=0,t},u.escapeTest=/[&<>"']/,u.escapeReplace=/[&<>"']/g,u.replacements={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},u.escapeTestNoEncode=/[<>"']|&(?!#?\w+;)/,u.escapeReplaceNoEncode=/[<>"']|&(?!#?\w+;)/g;var d={},g=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function b(){}function f(e){for(var t,n,s=1;s<arguments.length;s++)for(n in t=arguments[s],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function R(e,t){var n=e.replace(/\|/g,(function(e,t,n){for(var s=!1,a=t;--a>=0&&"\\"===n[a];)s=!s;return s?"|":" |"})),s=n.split(/ \|/),a=0;if(s.length>t)s.splice(t);else for(;s.length<t;)s.push("");for(;a<s.length;a++)s[a]=s[a].trim().replace(/\\\|/g,"|");return s}function y(e,t,n){if(0===e.length)return"";for(var s=0;s<e.length;){var a=e.charAt(e.length-s-1);if(a!==t||n){if(a===t||!n)break;s++}else s++}return e.substr(0,e.length-s)}function _(e,t){if(-1===e.indexOf(t[1]))return-1;for(var n=0,s=0;s<e.length;s++)if("\\"===e[s])s++;else if(e[s]===t[0])n++;else if(e[s]===t[1]&&(n--,n<0))return s;return-1}function E(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function k(e,t,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(n||"function"==typeof t){n||(n=t,t=null),t=f({},k.defaults,t||{}),E(t);var a,r,i=t.highlight,o=0;try{a=s.lex(e,t)}catch(e){return n(e)}r=a.length;var c=function(e){if(e)return t.highlight=i,n(e);var s;try{s=l.parse(a,t)}catch(t){e=t}return t.highlight=i,e?n(e):n(null,s)};if(!i||i.length<3)return c();if(delete t.highlight,!r)return c();for(;o<a.length;o++)!function(e){"code"!==e.type?--r||c():i(e.text,e.lang,(function(t,n){return t?c(t):null==n||n===e.text?--r||c():(e.text=n,e.escaped=!0,void(--r||c()))}))}(a[o])}else try{return t&&(t=f({},k.defaults,t)),E(t),l.parse(s.lex(e,t),t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(t||k.defaults).silent)return"<p>An error occurred:</p><pre>"+u(e.message+"",!0)+"</pre>";throw e}}b.exec=b,k.options=k.setOptions=function(e){return f(k.defaults,e),k},k.getDefaults=function(){return{baseUrl:null,breaks:!1,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:new i,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,xhtml:!1}},k.defaults=k.getDefaults(),k.Parser=l,k.parser=l.parse,k.Renderer=i,k.TextRenderer=o,k.Lexer=s,k.lexer=s.lex,k.InlineLexer=r,k.inlineLexer=r.output,k.Slugger=c,k.parse=k,e.exports=k}(this||("undefined"!=typeof window?window:global))},LRgy:function(e,t,n){e.exports={wrapper:"wrapper--22fvk",button:"button--1KxxK","thumbs-up":"thumbs-up--13f7z",thumbsUp:"thumbs-up--13f7z","thumbs-down":"thumbs-down--1COzs",thumbsDown:"thumbs-down--1COzs"}},PEPy:function(e,t,n){"use strict";var s=n("jiZR");t.a=e=>({type:s.SET_RELATED_DOCUMENTS,documents:e})},XMJP:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l}));var s=n("IkD9"),a=n.n(s),r=n("Pqt4");const i=(e,t)=>({"Document ID":e.id,Title:e.title,"New Title":e.new_title,"Upload Date":new Date(e.created_at).toISOString(),Downloads:e.downloads,Premium:e.premium||e.isPremium?1:0,Rating:e.rating,"Comment Count":t.length,"Has Direct Book Connection":Boolean(e.book_id),"Document Source":e.source,...e.course&&{"Course ID":e.course.id,"Course Code":e.course.code,"Course Name":e.course.name,...e.course.institution&&{"University ID":e.course.institution.id,"University Name":e.course.institution.name,"University Stage":e.course.institution.phase,...e.course.institution.country&&{"University Country ID":e.course.institution.country.id,"University Country Name":e.course.institution.country.name}}},"University Model":e.isFreeUniDocument?"Open":"Closed",...e.originalCategoryId&&{"Category ID":e.originalCategoryId,"Category Name":e.category_name}}),o=(e,t)=>{const n=t(),s=i(n.document.current,n.comment.comments);return a.a.track("Report Clicked",s)},l=(e,t)=>(n,s)=>{const o=s();let l={"Report Reason ID":e,"User Signed In":t};switch(e){case r.c.OTHER:l={...l,"Report Reason":"Other"};break;case r.c.MISSING_ANSWERS:l={...l,"Report Reason":"Missing Answers"};break;case r.c.WRONG_COURSE:l={...l,"Report Reason":"Wrong Course"};break;case r.c.WRONG_METADATA:l={...l,"Report Reason":"Title/Description"};break;case r.c.BAD_CONTENT:l={...l,"Report Reason":"Quality"};break;case r.c.CANT_READ:l={...l,"Report Reason":"Readability"}}const c=i(o.document.current,o.comment.comments);return a.a.track("Report Submitted",{...c,...l})}},bjR7:function(e,t,n){"use strict";var s=n("ZH6w");t.a=(e={})=>({type:s.a.SET_QUERY_PARAMS,params:e})},geob:function(e,t,n){"use strict";var s=n("q1tI"),a=n.n(s),r=n("17x9"),i=n.n(r),o=n("/MKj"),l=n("d2gv"),c=n.n(l),u=n("Xv2y"),p=n("CWhz"),m=n("2iE4");const h={show:i.a.bool.isRequired,onHide:i.a.func.isRequired};function d({show:e,onHide:t}){const n=Object(o.useSelector)(u.c),s=Object(o.useSelector)(u.e),r=Object(o.useSelector)(u.b),i=Object(o.useSelector)(u.a);return a.a.createElement(m.k,{show:e,onHide:t},a.a.createElement(m.k.Header,null,c.a.get("share_the_document")),a.a.createElement(m.k.Body,null,a.a.createElement(p.a,{shareUrl:n,whatsappUrl:s,messengerUrl:r,facebookUrl:i,socialShareTitle:c.a.get("share_on_social_medias"),urlShareTitle:c.a.get("share_url")})),a.a.createElement(m.k.Footer,null,a.a.createElement(m.k.CancelButton,null,c.a.get("close"))))}d.propTypes=h,t.a=a.a.memo(d)},odUq:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"a",(function(){return d}));var s=n("vDqi"),a=n.n(s),r=n("Elhd"),i=n.n(r),o=n("PMJz"),l=n("XMJP"),c=n("1dGI"),u=n("jiZR"),p=n("Pqt4");const m=(e=null)=>{const t=Object(c.c)(e),n=t.category.id===p.b.PAST_EXAMS?p.c.MISSING_ANSWERS:p.c.WRONG_COURSE;return{type:u.SET_DOCUMENT_REPORT_MODAL,step:p.d.PICK_REASON,currentReason:n}},h=(e,t)=>({type:u.SET_DOCUMENT_REPORT_MODAL,step:e,currentReason:t}),d=(e,t,n=null)=>(s,r)=>a.a.post(i.a.route("api.documents.report.store",{documentId:r().document.current.id}),{reasonId:e,...n&&{extraData:JSON.stringify(n)}}).then(()=>(s(Object(l.b)(e,t)),s({type:u.SUBMIT_REPORT}))).catch(e=>{throw s(Object(o.a)()),e})},ovGK:function(e,t,n){"use strict";var s=n("jiZR");t.a=(e=null)=>({type:s.SET_PREVIEW_TEXT,payload:e})},sygv:function(e,t,n){"use strict";var s=n("NsRu");t.a=e=>({type:s.SET_SEEN_DOCUMENTS_COUNT,seenDocumentsCount:e})},ySMY:function(e,t,n){"use strict";n("4Brf");var s=n("lSNA"),a=n.n(s),r=n("q1tI"),i=n.n(r),o=n("kX0S"),l=n("17x9"),c=n.n(l),u=n("d2gv"),p=n.n(u),m=n("Elhd"),h=n.n(m),d=n("TSYQ"),g=n.n(d),b=n("YcKG"),f=n.n(b),R=n("E51F"),y=n.n(R),_=n("DlQD"),E=n.n(_),k=n("IP2g");const v=new E.a.Renderer({});v.heading=(e,t)=>{if(e.trim().length)return t>1?`<h${t}>${e}</h${t}>`:e};var x=n("DHZf"),S=n("Xv2y"),w=n("4Rjq"),C=n("aVRt"),T=n("HxAO"),N=n("2p++"),O=n("bTYe");const A={document:c.a.object.isRequired,course:c.a.object.isRequired,configBookCategories:c.a.array.isRequired};function I({document:e,course:t,configBookCategories:n}){var s;const a=[i.a.createElement("li",{key:"institution",className:"first-info"},i.a.createElement("span",null,p.a.get("institution")),i.a.createElement("p",null,i.a.createElement(O.a,{institution:t.institution}))),i.a.createElement("li",{key:"course"},i.a.createElement("span",null,p.a.get("course")),i.a.createElement("p",null,i.a.createElement(N.a,{course:t})))];if(null===e.book&&n.includes(e.category_id)&&(null==t||null===(s=t.books)||void 0===s?void 0:s.length)>0){const e=t.books.slice(0,5).map(e=>i.a.createElement("a",{href:f.a.book(e),key:e.id},e.title));a.push(i.a.createElement("li",{key:"listedBooks"},i.a.createElement("span",null,p.a.get("listed_books")),i.a.createElement("p",null,e)))}if(e.book&&(a.push(i.a.createElement("li",{key:"bookTitle"},i.a.createElement("span",null,p.a.get("book_title")),i.a.createElement("a",{href:f.a.book(e.book)},e.book.title))),a.push(i.a.createElement("li",{key:"authors"},i.a.createElement("span",null,p.a.get("author")),i.a.createElement("p",null,e.book.author)))),!e.anonymous&&e.user&&""!==e.user.first_name&&""!==e.user.last_name&&0!==e.user.id){const t=i.a.createElement("a",{rel:"nofollow",href:h.a.route("userProfile",{id:e.user_id})},`${e.user.first_name} ${e.user.last_name}`);a.push(i.a.createElement("li",{key:"uploader"},i.a.createElement("span",null,p.a.get("uploader")),i.a.createElement("p",null,t)))}return e.academic_year&&a.push(i.a.createElement("li",{key:"academicYear"},i.a.createElement("span",null,p.a.get("academic_year")),i.a.createElement("p",null,e.academic_year))),i.a.createElement("ul",{className:"doc-info"},a)}I.propTypes=A;var D=I,q=n("pQ8y"),M=n("VeD8"),j=n("vDqi"),P=n.n(j),z=n("gPwu"),L=n("Ts+D"),$=n("IkD9"),B=n.n($),U=n("77UF");var F=e=>t=>B.a.track("Comment Posted",e).then(()=>t({type:L.TRACK_COMMENT_SUBMITTED})).catch(U.i),H=n("Fmmj"),Z=n("PMJz");var W=(e,t,n,s,a="Comment")=>r=>{const i=(new Date).getTime();return r(((e,t)=>({type:z.a.SUBMIT,comment:e,commentType:t}))({submitting:!0,checked:0,deleted:0,updated:null,comment:e,created:i,id:i,secondary_type_id:null,type:t,type_id:n,user:s,user_id:s.id},t)),P.a.post(h.a.route("APIcommentSubmit"),{comment:e,type:t,id:n,comment_nature:a}).then(e=>{var t,n;r((t=i,n=e.data.data.comment.id,{type:z.a.UPDATE_ID,commentId:t,newCommentId:n})),r(F(e.data.data.event.properties))}).catch(e=>{var n,s;throw r((n=i,s=t,{type:z.a.DESTROY,commentId:n,commentType:s})),r(Object(Z.a)(Object(H.a)(e))),e})};var G=(e,t)=>n=>P.a.post(h.a.route("APIcommentDestroy"),{commentId:e}).then(()=>n(((e,t)=>({type:z.a.DESTROY,commentId:e,commentType:t}))(e,t)));var K=(e,t,n)=>s=>P.a.post(h.a.route("APIcommentGetMore"),{type:e,id:t,offset:n}).then(e=>s((e=>({type:z.a.GET_MORE,commentObject:e.data}))(e.data))).catch(e=>e),V=n("pVnL"),Y=n.n(V),X=n("Yw+G"),J=n("pJVQ"),Q=n("2iE4"),ee=n("S3e9"),te=n("8R9t"),ne=n("V0l7");class se extends i.a.Component{render(){return i.a.createElement("div",null,i.a.createElement(ne.a,{size:"small",linkToProfile:!0}),i.a.createElement("form",{onSubmit:this.props.handleSubmit(this.props.onCommentSubmit),className:"comment-form comment-user-write"},i.a.createElement(te.a,{name:"comment",placeholder:p.a.get("write_comment"),ref:this.props.innerRef,disabled:this.props.submitting,hideErrors:!this.props.submitFailed}),i.a.createElement(Q.c,{color:"light",type:"submit",size:"small",className:"pull-right",disabled:this.props.submitting},p.a.get("post"))))}}a()(se,"propTypes",{onCommentSubmit:c.a.func.isRequired,...X.a});var ae=Object(J.a)({validate:({comment:e})=>({comment:Object(ee.a)(e)}),onSubmitSuccess:(e,t,n)=>n.reset()})(i.a.forwardRef((e,t)=>i.a.createElement(se,Y()({innerRef:t},e)))),re=n("/MKj"),ie=n("WKbj");class oe extends r.Component{constructor(...e){super(...e),a()(this,"state",{replying:!1}),a()(this,"handleRemoveComment",()=>{this.props.onRemove(this.props.comment.id)}),a()(this,"handleToggleCommentForm",()=>{this.setState(e=>({replying:!e.replying}))})}render(){let e,t,n;return this.props.user&&!this.props.comment.submitting&&(this.props.user.canDeleteAllComments||this.props.user.canDeleteComments&&this.props.user.id===this.props.comment.user_id)&&(e=i.a.createElement("div",{className:"pull-right"},i.a.createElement(k.a,{icon:"times",className:"remove-comment",size:"xs",onClick:this.handleRemoveComment}))),this.props.user&&this.props.user.isLoggedIn&&"comment"!==this.props.comment.type&&(t=this.state.replying?i.a.createElement("a",{className:"user-reply cancel-reply-toggle",onClick:this.handleToggleCommentForm},i.a.createElement("small",null,p.a.get("cancel"))):i.a.createElement("a",{className:"user-reply reply-toggle",onClick:this.handleToggleCommentForm},i.a.createElement("small",null,p.a.get("reply")))),null!==this.props.comment.user&&(n=this.props.comment.user.firstName),i.a.createElement("div",{key:"manager_"+this.props.comment.id},i.a.createElement("li",{id:"comment-"+this.props.comment.id,className:g()("comment-user-post clearfix",{"comment-user-post--submitting":this.props.comment.submitting})},i.a.createElement(Q.b,{size:"small",user:this.props.comment.user,linkToProfile:!0}),i.a.createElement("div",{className:"comment-user-txt"},i.a.createElement("span",null,i.a.createElement("a",{rel:"nofollow",href:h.a.route("userProfile",{id:this.props.comment.user_id})},n),"•",i.a.createElement(ie.a,{timestamp:this.props.comment.created,className:"comment-formatted-time"})),e,this.props.comment.comment.split("\n").map((e,t)=>i.a.createElement("p",{key:t,className:"comment-user-txt-write"},e)),t)),i.a.createElement(pe,{parentId:this.props.comment.id,showForm:this.state.replying,onSubmit:this.handleToggleCommentForm,type:"comment",id:this.props.comment.id}))}}a()(oe,"propTypes",{comment:c.a.object.isRequired,onRemove:c.a.func,user:c.a.object});var le=Object(re.connect)()(oe),ce=n("CMp5");class ue extends r.Component{constructor(...e){super(...e),a()(this,"state",{showRemoveCommentModal:!1}),a()(this,"handleShowRemoveCommentModal",e=>{this.setState({commentIdToRemove:e,showRemoveCommentModal:!0})}),a()(this,"handleHideRemoveCommentModal",()=>{this.setState({showRemoveCommentModal:!1,commentIdToRemove:null})}),a()(this,"handleRemoveComment",()=>{const e=this.props.dispatch(G(this.state.commentIdToRemove,this.props.type));return this.handleHideRemoveCommentModal(),e}),a()(this,"handleCommentSubmit",({comment:e})=>("function"==typeof this.props.onSubmit&&this.props.onSubmit(),this.props.dispatch(W(e,this.props.type,this.props.id,this.props.user)))),a()(this,"handleMoreComments",()=>{this.props.dispatch(K(this.props.type,this.props.id,this.props.offset))}),a()(this,"_mainTextarea",i.a.createRef())}componentDidUpdate(e){e.focusTextarea!==this.props.focusTextarea&&setTimeout(()=>this._mainTextarea.current.focus(),0)}render(){let e,t,n;this.props.user&&this.props.user.isLoggedIn&&(this.props.showForm||0===this.props.parentId)?e=i.a.createElement("li",{className:"comment-user-space clearfix"},i.a.createElement(ae,{ref:this._mainTextarea,onCommentSubmit:this.handleCommentSubmit,form:"CommentForm-"+this.props.parentId})):this.props.parentId||(e=i.a.createElement("li",{className:"comment-no-login"},p.a.get("login_for_comment"))),this.props.comments&&this.props.comments.length>0&&(t=this.props.comments.map(e=>i.a.createElement(q.a,{key:e.id,classNames:"fadeIn",timeout:100},i.a.createElement(le,{onRemove:this.handleShowRemoveCommentModal,comment:e,user:this.props.user}))));let s=this.props.commentCount-5;return!this.props.parentId&&s>0&&(s>5&&(s=5),n=i.a.createElement("div",{className:"mt1x",key:"moreComments"+s},i.a.createElement(Q.c,{size:"small-wide",color:"outline-primary",onClick:this.handleMoreComments},p.a.choice("show_last_comments",s,{commentCount:s})))),i.a.createElement("div",{className:g()({"comment-reply":this.props.parentId})},e,i.a.createElement(M.a,null,t),n,i.a.createElement(ce.a,{title:p.a.get("delete_comment"),show:this.state.showRemoveCommentModal,onYes:this.handleRemoveComment,onNo:this.handleHideRemoveCommentModal,yesTestSelector:"confirm-remove-comment-button"},p.a.get("delete_sure_comment")))}}a()(ue,"propTypes",{focusTextarea:c.a.bool,comments:c.a.array,commentCount:c.a.any,offset:c.a.number,parentId:c.a.number,type:c.a.string,id:c.a.any,showForm:c.a.bool,onSubmit:c.a.func,user:c.a.object,dispatch:c.a.func});var pe=Object(o.connect)((e,t)=>({comments:e.comment.comments.filter(e=>"comment"!==e.type&&0===t.parentId||e.type_id===t.parentId),type:0===t.parentId?e.comment.type:t.type,id:0===t.parentId?e.comment.id:t.id,user:e.user,offset:e.comment.offset,commentCount:e.comment.commentCount}))(ue),me=n("+6pD"),he=n("BM24"),de=n("xZ14"),ge=n("wQmL");class be extends r.Component{constructor(...e){super(...e),a()(this,"handleFormSubmit",e=>this.props.handleCommentSubmit({...this.props.comment,text:e["comment-positive"]},this.props.user))}render(){let e=null;return this.props.show&&(e=i.a.createElement("div",{className:"comment-modal-form modal fade in"},i.a.createElement("div",{className:"modal-dialog"},i.a.createElement("div",{className:"modal-content"},i.a.createElement("div",{className:"modal-header"},i.a.createElement("h4",{className:"modal-title"},p.a.get("leave_comment"))),i.a.createElement("form",{onSubmit:this.props.handleSubmit(this.handleFormSubmit)},i.a.createElement("div",{className:"modal-body"},i.a.createElement(te.a,{id:"comment",name:"comment-positive",placeholder:p.a.get("leave_comment_desc"),minLength:10,maxLength:255})),i.a.createElement("div",{className:"modal-footer"},i.a.createElement(Q.d,null,i.a.createElement(Q.c,{color:"gray-text",type:"button",onClick:this.props.onDismiss},p.a.get("skip")),i.a.createElement(Q.e,{type:"submit",loading:this.props.submitting,disabled:this.props.submitting},p.a.get("post"))))))))),e}}a()(be,"propTypes",{...X.a});be=Object(J.a)({form:"CommentModalForm",validate:e=>({"comment-positive":Object(ee.a)(e["comment-positive"])})})(be);var fe=Object(o.connect)(e=>({comment:{id:e.comment.id,type:e.comment.type},user:e.user}),(e,t)=>({handleCommentSubmit:(t,n)=>{e(W(t.text,t.type,t.id,n,"Review"))},onSubmitSuccess:()=>{t.onDismiss(),Object(ge.c)("CommentModalForm")}}))(be),Re=n("ewcA"),ye=n("4V4G"),_e=n.n(ye);const Ee={onHide:c.a.func.isRequired,onRate:c.a.func.isRequired,document:c.a.shape({id:c.a.number.isRequired,rating_positive:c.a.number.isRequired,rating_negative:c.a.number.isRequired,user_rating:c.a.number}).isRequired};function ke({document:e,onRate:t,onHide:n}){return i.a.createElement("div",{className:_e.a.popUp},i.a.createElement("button",{type:"button",className:_e.a.closeButton,onClick:n},i.a.createElement(k.a,{icon:"times"})),i.a.createElement(Q.t,{component:"div",size:"big",className:_e.a.text},p.a.get("document_helpful")),i.a.createElement("div",{className:_e.a.rateButtonsWrapper},i.a.createElement(me.a,{documentId:e.id,positiveRatings:e.rating_positive,negativeRatings:e.rating_negative,onRate:t,userRating:e.user_rating,ratingOrigin:"Overlay",readOnly:!1,showRatingText:!1})))}ke.propTypes=Ee;var ve=ke,xe=n("rCUD");const Se={documentPreviewText:c.a.object.isRequired,configBookCategories:c.a.array.isRequired,className:c.a.string,user:c.a.shape({id:c.a.number,isLoggedIn:c.a.bool.isRequired,isStaff:c.a.bool.isRequired}).isRequired,onShowReportDocumentModal:c.a.func.isRequired,course:c.a.object.isRequired,document:c.a.object.isRequired,relatedStudylists:c.a.arrayOf(c.a.shape({id:c.a.number.isRequired,name:c.a.string.isRequired})),userHasReachedRatingLimit:c.a.bool.isRequired,open:c.a.bool.isRequired,userHasCommented:c.a.bool.isRequired,onSidebarToggle:c.a.func.isRequired,relatedDocuments:c.a.arrayOf(c.a.shape({id:c.a.number.isRequired,title:c.a.string.isRequired,category:c.a.object,pages:c.a.number,isPremium:c.a.bool,isApproved:c.a.bool,activeFile:c.a.shape({pages:c.a.number.isRequired}),isNew:c.a.bool,academicYear:c.a.string,rating:c.a.object,userStudylistIds:c.a.array})),shouldAskToRate:c.a.bool.isRequired,onRelatedDocumentClick:c.a.func.isRequired,onShowShareModal:c.a.func.isRequired,cdn:c.a.shape({cdn_enabled:c.a.bool}).isRequired,isMobile:c.a.bool};class we extends r.Component{constructor(...e){super(...e),a()(this,"state",{showOverlay:!1,showCommentModalForm:!1,open:!0,showAskToRate:!1,focusComment:!1}),a()(this,"handleVote",e=>{clearTimeout(this.askToRateTimeout);let t={rating:e,showOverlay:!1,showAskToRate:!1};this.props.user.isLoggedIn&&1===e&&!this.props.userHasCommented?t={...t,showOverlay:!0,showCommentModalForm:!0}:-1!==e||this.props.document.user_reported_document||this.props.userHasReachedRatingLimit||this.handleShowReportDocumentModal(!0),this.setState(t)}),a()(this,"handleRemoveOverlay",()=>{this.setState({showOverlay:!1,showAskToRate:!1,showCommentModalForm:!1})}),a()(this,"handleCommentButtonClicked",()=>{this.setState({focusComment:!0,open:!0},()=>{this.props.onSidebarToggle("Comment Button")})}),a()(this,"handleShowReportDocumentModal",e=>{this.handleRemoveOverlay(),this.props.onShowReportDocumentModal(e)})}static getDerivedStateFromProps(e,t){return e.open!==t.open?{open:e.open}:null}componentDidMount(){const e=()=>{this.state.showCommentModalForm||this.setState({showOverlay:!1,showAskToRate:!1,showCommentModalForm:!1})},t=()=>{this.setState({showOverlay:!0,showAskToRate:!0},()=>setTimeout(e,x.b))};this.props.shouldAskToRate&&(this.askToRateTimeout=setTimeout(t,x.a))}render(){let e,t,n,s,a,r;return!this.props.document.description||this.props.document.description.includes("http")||this.props.document.description.includes("merged files")||(e=i.a.createElement(he.a,{className:"comment",expandedClassName:"comment expanded",text:this.props.document.description})),this.props.user.isLoggedIn&&this.props.user.isStaff&&(t=i.a.createElement(Q.c,{component:"a",size:"small-wide",color:"premium",href:h.a.route("cmsDocumentEdit",{id:this.props.document.id}),rel:"noopener noreferrer",target:"_blank"},i.a.createElement(k.a,{icon:"pencil-alt"})," ",p.a.get("edit"))),this.props.relatedStudylists&&this.props.relatedStudylists.length&&(n=i.a.createElement("div",{className:"document-viewer-sidebar__related-material"},i.a.createElement("div",{className:"h3-stu comments"},p.a.get("related_studylists")),this.props.relatedStudylists.map(e=>{const t=h.a.route("studylists.show",{studylistId:e.id,name:y()(e.name)});return i.a.createElement("a",{key:e.id,href:t,rel:"nofollow",title:e.name,className:"ic-text document-line"},i.a.createElement(Re.a,{size:"small"}),i.a.createElement("span",{className:"text-ellipsis"},e.name))}))),this.props.relatedDocuments.length>0&&!this.props.isMobile&&(s=i.a.createElement("div",{className:"document-viewer-sidebar__related-material"},i.a.createElement(xe.a,{relatedDocuments:this.props.relatedDocuments,dataTestSelector:"related-documents-sidebar",onRelatedDocumentClicked:this.props.onRelatedDocumentClick,cdn:this.props.cdn}))),this.props.documentPreviewText.previewText&&(a=this.props.documentPreviewText.isMD?i.a.createElement("div",{className:"document-viewer-sidebar__preview"},i.a.createElement("div",{className:"h3-stu"},p.a.get("preview_text")),i.a.createElement("div",{className:"md",dangerouslySetInnerHTML:{__html:E()(this.props.documentPreviewText.previewText,{renderer:v})}})):i.a.createElement("div",{className:"document-viewer-sidebar__preview"},i.a.createElement("div",{className:"h3-stu"},p.a.get("preview_text")),i.a.createElement("textarea",{rows:5,value:this.props.documentPreviewText.previewText,readOnly:!0}))),this.props.user.isLoggedIn&&(r=i.a.createElement(Q.c,{color:"light",size:"minimum",className:"light-social-button-wrapper__button",onClick:this.handleCommentButtonClicked},i.a.createElement(k.a,{icon:"comment"}))),i.a.createElement("div",{className:g()("document-viewer-sidebar",this.props.className,{"small-sidebar":!this.state.open})},i.a.createElement("div",{className:g()({hidden:!this.state.open})},i.a.createElement(de.a,{show:this.state.showOverlay,onClick:this.handleRemoveOverlay}),this.state.showAskToRate&&i.a.createElement(ve,{document:this.props.document,onHide:this.handleRemoveOverlay,onRate:this.handleVote}),i.a.createElement(fe,{show:this.state.showCommentModalForm,onDismiss:this.handleRemoveOverlay}),i.a.createElement("div",{className:"info-side-bar"},i.a.createElement("h1",{className:"doc-title"},this.props.document.title),e,t,i.a.createElement(D,{document:this.props.document,configBookCategories:this.props.configBookCategories,course:this.props.course,user:this.props.user}),i.a.createElement("div",{className:"document-info-row doc-rate-row"},i.a.createElement(me.a,{documentId:this.props.document.id,positiveRatings:this.props.document.rating_positive,negativeRatings:this.props.document.rating_negative,onRate:this.handleVote,readOnly:Boolean(this.props.document.preview||this.props.document.isMine),userRating:this.props.document.user_rating,showRatingText:!0,ratingOrigin:"Sidebar"})),this.props.user.isLoggedIn&&i.a.createElement("div",{className:"document-info-row report-flag-own-row"},i.a.createElement(Q.c,{size:"minimum",color:"gray-text",onClick:()=>this.handleShowReportDocumentModal(!1),disabled:this.props.document.user_reported_document},i.a.createElement(k.a,{icon:"flag"}),i.a.createElement("span",null,p.a.get("report_document")))),i.a.createElement("div",{className:"share-button-wrapper"},i.a.createElement(Q.c,{color:"light",type:"button",size:"small-wide",rel:"nofollow",onClick:this.props.onShowShareModal},i.a.createElement(k.a,{icon:"share"})," ",p.a.get("share"))),i.a.createElement("div",{className:"side-bar-comments"},i.a.createElement("div",{className:"h3-stu"},p.a.get("comments")),i.a.createElement("ul",{id:"comment-listing"},i.a.createElement(pe,{focusTextarea:this.state.focusComment,parentId:0}))),s,n,a)),i.a.createElement("div",{className:g()("light-social-button-wrapper",{hidden:this.state.open})},i.a.createElement(Q.c,{color:"light",size:"minimum",className:"light-social-button-wrapper__button",onClick:this.props.onShowShareModal},i.a.createElement(k.a,{icon:"share"})),r))}}we.propTypes=Se,we.defaultProps={className:null,relatedStudylists:[],relatedDocuments:[],isMobile:!1};t.a=Object(o.connect)(e=>{const{comments:t}=e.comment,n=e.comment.type,s=e.user.id;return{userHasCommented:t&&t.some(e=>e.type===n&&e.user_id===s),documentPreviewText:e.document.previewText||null,shouldAskToRate:Object(S.f)(e),cdn:Object(w.a)(e),userHasReachedRatingLimit:Object(S.g)(e),isMobile:e.meta.isMobile}},e=>({onRelatedDocumentClick:(t,n,s,a)=>e(Object(C.a)(n,t,{href:f.a.document(s),isNewTab:a},"Viewer Sidebar")),onShowShareModal:()=>e(Object(T.a)("Sidebar"))}))(we)}}]);