(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[123],{"62OU":function(e,t,a){e.exports={"cta-wrapper":"cta-wrapper--3HSla",ctaWrapper:"cta-wrapper--3HSla",show:"show--iXH-E",text:"text--21H9J",button:"button--y0yEK"}},JcMM:function(e,t,a){e.exports={choice:"choice--T1a2q"}},kajk:function(e,t,a){"use strict";var s=a("lSNA"),i=a.n(s),r=a("q1tI"),n=a.n(r),o=a("/MKj"),c=a("YcKG"),l=a.n(c),p=a("d2gv"),h=a.n(p),u=a("17x9"),m=a.n(u),g=a("TSYQ"),d=a.n(g),b=a("IP2g"),y=a("tOm5"),k=a.n(y),v=a("Aj+2"),E=a("b4qD");var P=(e={})=>{const{isPremium:t,className:a}=e;let s;return t&&(s=n.a.createElement(E.a,{className:"category-tag__icon"})),n.a.createElement("span",{className:d()("category-tag",{"category-tag--premium":t},a)},n.a.createElement("span",{className:d()({"ic-text":t})},s,e.children))},f=a("2iE4"),C=a("62OU"),N=a.n(C),R=a("ANjH"),S=a("Yw+G"),_=a("pJVQ"),F=a("JcMM"),w=a.n(F),M=a("W4C7"),I=a("dq6K"),T=a("S3e9");const j=["Wrong Title/Author","Wrong Language","Wrong Course/Uni","Document too old","Poor quality","Other"];var O=a("Uyi2");const D=e=>e.search.queries[O.i],q=e=>e.search.filters[O.i],x=e=>e.search.feedbackChoices.map(e=>({value:e.id,label:h.a.get(e.messageKey)})),U={show:m.a.bool.isRequired,onHide:m.a.func.isRequired,onSubmitFeedback:m.a.func.isRequired,...S.a};class L extends r.Component{constructor(...e){super(...e),i()(this,"handleSubmit",e=>this.props.onSubmitFeedback(e))}render(){return n.a.createElement(f.k,{show:this.props.show,onHide:this.props.onHide,size:"small"},n.a.createElement("form",{onSubmit:this.props.handleSubmit(this.handleSubmit),method:"POST"},n.a.createElement(f.k.Body,{className:w.a.body},n.a.createElement("div",{className:"form-group"},n.a.createElement("div",{className:"radio-checkbox-group"},n.a.createElement(M.c,{name:"feedbackId",label:h.a.get("what_do_you_think"),labelClassName:"font-small font-bold mb1x",optionClassName:w.a.choice,options:this.props.choices,parse:Number}))),n.a.createElement(I.a,{name:"optionalComment",type:"text",placeholder:h.a.get("type_your_suggestions"),label:h.a.get("comments_or_suggestions_optional"),autoComplete:"off"}),n.a.createElement(f.t,{color:"gray"},h.a.get("data_helps_improve_search"))),n.a.createElement(f.k.Footer,{className:w.a.footer},n.a.createElement(f.d,null,n.a.createElement(f.k.CancelButton,null,h.a.get("cancel")),n.a.createElement(f.k.SubmitButton,{component:f.e,type:"submit",loading:this.props.submitting,disabled:this.props.submitting},h.a.get("send"))))))}}L.propTypes=U;var A=Object(R.d)(Object(o.connect)(e=>({choices:x(e),initialValues:{reply:1}})),Object(_.a)({form:"SearchResultFeedbackModal",validate:e=>({optionalComment:6===e.feedbackId&&Object(T.l)(e.optionalComment,"comment")})}))(L),H=a("vDqi"),W=a.n(H),K=a("Elhd"),Y=a.n(K),B=a("Fmmj"),J=a("PMJz"),V=a("N4+1"),z=a("0pXI");var Q=(e,t,a)=>s=>s(Object(z.a)("Search Result Feedback Submitted",{"Document ID":e,"Search Result Feedback Choice":t.feedbackId,"Search Result Feedback Label":j[t.feedbackId],...a}));var G=(e,t)=>(a,s)=>{const i=s().search.filters[O.i];return W.a.post(Y.a.route("api.search.feedback.store"),{documentId:e,feedbackId:t.feedbackId,optionalComment:t.optionalComment,searchParameters:{filters:q(s()),query:D(s())}}).then(r=>{const n={"Search Query":D(s()),...i.institution&&{"Filter University ID":i.institution.id,"Filter University Name":i.institution.name},...i.course&&{"Filter Course ID":i.course.id,"Filter Course Name":i.course.name},...i.category&&{"Filter Category ID":i.category.id.replace("category_",""),"Filter Category Name":s().document.uploaderConfig.find(e=>e.label===i.category.id).englishTranslation},...i.languages&&{"Filter Language IDs":i.languages.map(e=>e.replace("language_","")).join(", ")}};return a(Q(e,t,n)),a(Object(V.a)(h.a.get("your_feedback_thanks"))),r}).catch(e=>{throw a(Object(J.a)(Object(B.a)(e))),e})};const $={show:m.a.bool,documentId:m.a.number.isRequired};function X({show:e=!1,documentId:t}){const a=Object(o.useDispatch)(),[s,i]=Object(r.useState)(!1);return n.a.createElement("div",{className:d()(N.a.ctaWrapper,{[N.a.show]:e})},n.a.createElement(f.t,{className:N.a.text},h.a.get("not_what_you_were_looking_for")," "),n.a.createElement(f.c,{onClick:()=>i(!0),color:"link",size:"minimum",className:N.a.button},h.a.get("tell_us_more")),n.a.createElement(A,{show:s,onHide:()=>i(!1),onSubmitFeedback:e=>{a(G(t,e)),i(!1)}}))}X.propTypes=$;var Z=X,ee=a("77UF");var te=a("1dGI"),ae=a("Mwj6");var se=e=>(t,a)=>{const s=q(a()),i={"Search Query":D(a()),...s.institution&&{"Filter University ID":s.institution.id,"Filter University Name":s.institution.name},...s.course&&{"Filter Course ID":s.course.id,"Filter Course Name":s.course.name},...s.category&&{"Filter Category ID":s.category.id.replace("category_",""),"Filter Category Name":a().document.uploaderConfig.find(e=>e.label===s.category.id).englishTranslation},...s.languages&&{"Filter Language IDs":s.languages.map(e=>e.replace("language_","")).join(", ")}};return t(Object(z.a)("Search Result Feedback Shown",{"Document ID":e,...i}))};const ie={id:m.a.string.isRequired,url:m.a.string.isRequired,searchPos:m.a.number.isRequired,user:m.a.object,query:m.a.string,name:m.a.string,rating:m.a.number,premium:m.a.bool,category:m.a.string,categoryId:m.a.number,course:m.a.object,institution:m.a.object,book:m.a.object,study:m.a.array,onElementClicked:m.a.func,dataTestSelector:m.a.string,thumbnailUrl:m.a.string,largeThumbnailUrl:m.a.string,pages:m.a.number,formatLanguage:m.a.string.isRequired,searchFilters:m.a.object,examDate:m.a.shape({exam_day:m.a.number,exam_month:m.a.number,exam_year:m.a.number.isRequired,exam_semester:m.a.string}),academicYear:m.a.oneOfType([m.a.string,m.a.array]),createdAt:m.a.number,positiveRating:m.a.number,negativeRating:m.a.number,testRatingsTimeRange:m.a.string,ratingPast15Months:m.a.number,ratingPositivePast15Months:m.a.number,ratingNegativePast15Months:m.a.number,ratingPast18Months:m.a.number,ratingPositivePast18Months:m.a.number,ratingNegativePast18Months:m.a.number,onThumbnailClick:m.a.func.isRequired,onTrackSearchResultFeedbackShown:m.a.func.isRequired,testSearchResultsFeedback:m.a.string};class re extends r.Component{constructor(...e){super(...e),i()(this,"state",{showFeedbackRequest:!1}),i()(this,"handleUrlClicked",e=>{e.stopPropagation()}),i()(this,"handleThumbnailClick",e=>{this.props.onThumbnailClick(Object(ee.e)(this.props.thumbnailUrl)),this.handleElementClicked(e,"Thumbnail")}),i()(this,"handleElementClicked",(e,t)=>{var a,s;e.stopPropagation(),e.preventDefault();let i="None";const r=Object(ae.a)(e);if(this.props.largeThumbnailUrl?i="Big":this.props.thumbnailUrl&&(i="Small"),"Ask"===this.props.testSearchResultsFeedback){const{hidden:e,visibilityChange:t}=Object(ee.g)(document.msHidden)?Object(ee.g)(document.webkitHidden)?{hidden:"hidden",visibilityChange:"visibilitychange"}:{hidden:"webkitHidden",visibilityChange:"webkitvisibilitychange"}:{hidden:"msHidden",visibilityChange:"msvisibilitychange"};document.addEventListener(t,()=>{document[e]||this.state.showFeedbackRequest||(this.setState({showFeedbackRequest:!0}),this.props.onTrackSearchResultFeedbackShown(this.props.id))})}this.props.onElementClicked({type:"document",id:this.props.id,searchPos:this.props.searchPos,location:"search",href:this.props.url,openInNewTab:r,category:this.props.category,categoryId:this.props.categoryId,query:this.props.query,name:this.props.name,institution:this.props.institution,course:this.props.course,rating:this.props.rating,pages:this.props.pages,premium:this.props.premium,institutionFilter:null===(a=this.props.searchFilters)||void 0===a?void 0:a.institution,courseFilter:null===(s=this.props.searchFilters)||void 0===s?void 0:s.course,positiveRating:this.props.positiveRating,negativeRating:this.props.negativeRating,ratingPast15Months:this.props.ratingPast15Months,ratingPositivePast15Months:this.props.ratingPositivePast15Months,ratingNegativePast15Months:this.props.ratingNegativePast15Months,ratingPast18Months:this.props.ratingPast18Months,ratingPositivePast18Months:this.props.ratingPositivePast18Months,ratingNegativePast18Months:this.props.ratingNegativePast18Months,origin:t,thumbnailType:i})}),i()(this,"highlightMatches",e=>{const t=this.props.query&&this.props.query.toLowerCase(),a=e.toLowerCase().indexOf(t);let s;return s=t&&-1!==a?n.a.createElement("span",null,e.slice(0,a),n.a.createElement("span",{className:"font-bold"},e.slice(a,a+t.length)),e.slice(a+t.length)):n.a.createElement("span",null,e),s}),i()(this,"renderDate",()=>{const e=Object(te.b)({exam:this.props.examDate,academicYear:this.props.academicYear,createdAt:this.props.createdAt},this.props.formatLanguage);return n.a.createElement("span",{className:"ic-text",key:"date"},n.a.createElement(b.a,{icon:["far","calendar-alt"]})," ",e)}),i()(this,"getRating",()=>"15 Months"===this.props.testRatingsTimeRange?{total:this.props.ratingPast15Months,positive:this.props.ratingPositivePast15Months,negative:this.props.ratingNegativePast15Months}:"18 Months"===this.props.testRatingsTimeRange?{total:this.props.ratingPast18Months,positive:this.props.ratingPositivePast18Months,negative:this.props.ratingNegativePast18Months}:{total:this.props.rating,positive:this.props.positiveRating,negative:this.props.negativeRating}),i()(this,"getCategoryId",()=>this.props.categoryId?this.props.categoryId:this.props.category?parseInt(this.props.category.split("_")[1],10):0)}render(){const e=n.a.createElement(v.a,{key:"thumbRating",className:k.a.rating,rating:this.getRating().total,positiveCount:this.getRating().positive,negativeCount:this.getRating().negative,dataTestSelector:"thumbs-rating"});let t=!1;this.props.premium&&this.props.user.isLoggedIn&&this.props.user.allowsPremiumDocuments&&(!this.props.user.isPremium||this.props.user.isStaff)&&(t=!0);const a=this.getCategoryId(),s=l.a.course({...this.props.course,institution:this.props.institution,document_count:1});let i=this.props.course.name;this.props.course.code&&(i+=` (${this.props.course.code})`),i=this.highlightMatches(i);const r=n.a.createElement("a",{href:s,onClick:this.handleUrlClicked,className:k.a.course},i);let o,c,p,u;this.props.institution&&(o=n.a.createElement("span",{className:"font-small"},this.props.institution.name),c=n.a.createElement(b.a,{icon:"circle",className:k.a.courseInstitutionSeparator})),this.props.institution.study_search_is_visible&&this.props.study.length&&(p=n.a.createElement("p",{className:k.a.studies},this.props.study.map(e=>e.name).join(", "))),this.props.book&&(u=n.a.createElement("div",null,n.a.createElement("a",{className:k.a.book,href:l.a.book(this.props.book),onClick:this.handleUrlClicked},this.highlightMatches(`${this.props.book.title} - ${this.props.book.author}`))));const m=[];Object(ee.e)(this.props.pages)&&m.push(n.a.createElement("span",{className:"ic-text",key:"pages"},n.a.createElement(b.a,{icon:["far","file-alt"]}),h.a.choice("n_pages",this.props.pages,{n:parseInt(this.props.pages,10).toLocaleString(this.props.formatLanguage)}))),m.push(this.renderDate()),m.push(n.a.createElement(f.i,{md:!0,lg:!0,key:"rating-desktop"},e));const g=n.a.createElement("div",{className:k.a.meta},m);return n.a.createElement("li",{className:k.a.searchDocumentResult},n.a.createElement("div",{className:k.a.documentThumbnail},n.a.createElement(f.u,{href:this.props.url,onClick:this.handleThumbnailClick,thumbnailUrl:this.props.thumbnailUrl,size:"small"})),n.a.createElement("div",{className:k.a.details},n.a.createElement("a",{href:this.props.url,onClick:e=>this.handleElementClicked(e,"Title"),className:k.a.titleWrapper},n.a.createElement("h3",{className:k.a.title},this.props.name),n.a.createElement(P,{className:d()(k.a.category,{[k.a.premium]:t}),isPremium:t,dataTestSelector:t&&"premium-doc-label"+(this.props.category&&"-"+this.props.category),key:"category"},h.a.get("category_"+a))),n.a.createElement("div",null,r,c,o),p,u,g,"Ask"===this.props.testSearchResultsFeedback&&n.a.createElement(Z,{show:this.state.showFeedbackRequest,documentId:Number(this.props.id)})),n.a.createElement(f.i,{xxs:!0,xs:!0,sm:!0},e))}}re.propTypes=ie,re.defaultProps={user:null,query:"",name:"",rating:0,premium:!1,category:"",categoryId:0,course:null,institution:null,book:null,study:[],onElementClicked:null,dataTestSelector:null,thumbnailUrl:"",largeThumbnailUrl:"",pages:null,searchFilters:null,academicYear:null,examDate:null,createdAt:null,positiveRating:0,negativeRating:0,testRatingsTimeRange:null,ratingPast15Months:0,ratingPositivePast15Months:0,ratingNegativePast15Months:0,ratingPast18Months:0,ratingPositivePast18Months:0,ratingNegativePast18Months:0,testSearchResultsFeedback:null};t.a=Object(o.connect)(e=>({testSearchResultsFeedback:e.ab.testSearchResultsFeedback}),e=>({onThumbnailClick:t=>e(Object(z.a)("Search Thumbnail Clicked",{"Has Thumbnail":t})),onTrackSearchResultFeedbackShown:t=>e(se(t))}))(re)},tOm5:function(e,t,a){e.exports={"search-document-result":"search-document-result--PI2li",searchDocumentResult:"search-document-result--PI2li",details:"details--rAn2j",rating:"rating--1a_ci","title-wrapper":"title-wrapper--1pLt8",titleWrapper:"title-wrapper--1pLt8",title:"title--3iFfl",category:"category--136Vn",premium:"premium--34aie",course:"course--7wdPm","course-institution-separator":"course-institution-separator--1ivW9",courseInstitutionSeparator:"course-institution-separator--1ivW9",studies:"studies--jfOpS",book:"book--2HwZI",meta:"meta--1Fdrl","document-thumbnail":"document-thumbnail--3Vmht",documentThumbnail:"document-thumbnail--3Vmht"}}}]);